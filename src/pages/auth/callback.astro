---
import {getAuthToken} from "@src/utils/spotify";
import Dump from "@src/components/Dump.astro";

const code = Astro.url.searchParams.get('code');
const authToken = await getAuthToken({code}) 

Astro.cookies.set('spotify-auth-token', authToken, {path: '/', httpOnly: true, sameSite: 'lax'});

return Astro.redirect('/app/?status=logged-in');
---

<Dump data={authToken} />
